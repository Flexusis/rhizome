<!DOCTYPE html>
<html>
<head>
  <title>Rhizome example</title>
  <script src="/rhizome/rhizome.js"></script>
  <script src="js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" type="text/css" href="css/styles.css" />
  <script>
    $(function() {

      var clickTraceRadius = 30

      var createClickTrace = function(clickX, clickY) {
        clickTrace = $('<div>', {'class': 'clickTrace'})
          .appendTo('#upperCanvas')
          .css({
            left: clickX - clickTraceRadius,
            top: clickY - clickTraceRadius,
            width: clickTraceRadius * 2,
            height: clickTraceRadius * 2,
            'border-radius': clickTraceRadius
          })
      }

      var logMessage = function(cssSelector, msg) {
        $('<div>', {'class': 'logMessage'})
          .html(msg)
          .prependTo(cssSelector)
      }

      rhizome.start(function() {

        $('#upperCanvas').click(function(event) {
          var args = [rhizome.userId, event.pageX, event.pageY]
          var address = '/click'
          createClickTrace(event.pageX, event.pageY)
          rhizome.message(address, args)
          logMessage('#upperCanvas .console', 'SENT : [' + address + ' ' + args.toString() + ']')
        })

        rhizome.listen('/color', function(address, args) {
          if (address === '/color/upperCanvas') $('#upperCanvas').css({'background-color': args[0]})
          else if (address === '/color/lowerCanvas') $('#lowerCanvas').css({'background-color': args[0]})
          else return logMessage('#lowerCanvas .console', 'RECEIVED unknown element : ' + address)
          logMessage('#lowerCanvas .console', 'RECEIVED : [' + address + ' ' + args.toString() + ']')
        })

      })

    })
  </script>
</head>

<body>
  <div id="upperCanvas">
    <div><b>[Web page -> OSC]</b> click here to send a message to the OSC clients</div>
    <div class="console"></div>
  </div>
  <div id="lowerCanvas">
    <div><b>[OSC -> Web page]</b> when an OSC message is received, it changes the color here</div>
    <div class="console"></div>
  </div>
</body>

</html> 
